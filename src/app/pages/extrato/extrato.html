@if(carregando()) {
<div class="container p-2 pt-0">
  <mat-card>
    <mat-card-content>
      <div class="d-flex flex-column align-items-center gap-3">
        <mat-spinner diameter="40" color="primary"></mat-spinner>
        <p class="mb-0">Carregando...</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>
}
<div class="container p-2 pb-0" [class.visually-hidden]="!!carregando()">
  <mat-card
    class="p-2"
    appearance="filled"
    (click)="navegarPainelFaturas()"
    role="button"
    tabindex="0"
    (keydown.enter)="navegarPainelFaturas()"
    (keydown.space)="navegarPainelFaturas()"
    aria-label="Ver painel de faturas"
  >
    <mat-card-header class="p-0 d-flex justify-content-center">
      <mat-card-title>{{
        faturaAtiva().nome_fatura || "Nenhuma fatura selecionada"
      }}</mat-card-title>
    </mat-card-header>
    <mat-card-content class="p-0 text-center">
        @if(faturaAtiva().codigo_fatura) {
        {{ formatarParaData(faturaAtiva().data_abertura_fatura) }} -
        {{ formatarParaData(faturaAtiva().data_fechamento_fatura) }}
        } @else { Mostrando compras dos Ãºltimos 30 dias }
      </mat-card-content>
  </mat-card>
</div>
<div class="container p-2" [class.visually-hidden]="!!carregando()">
  <mat-card appearance="filled">
    <mat-card-content class="p-2">
      <table
        mat-table
        [dataSource]="dataSource"
        style="background-color: transparent"
      >
        <ng-container matColumnDef="codigo_categoria_compra">
          <th
            class="p-2"
            mat-header-cell
            *matHeaderCellDef
            style="width: 40px"
          ></th>
          <td class="p-2" mat-cell *matCellDef="let element">
            <mat-icon>{{
              categoriaCompra(element.codigo_categoria_compra).icon
            }}</mat-icon>
          </td>
        </ng-container>
        <ng-container matColumnDef="descricao_compra">
          <th class="p-0" mat-header-cell *matHeaderCellDef>
            <b>{{ titulo }}</b>
          </th>
          <td class="p-0" mat-cell *matCellDef="let element">
            <span>{{ formatarParaData(element.data_compra) }}</span>
            <br />
            <b>{{ element.descricao_compra.toUpperCase() }}</b>
          </td>
        </ng-container>
        <ng-container matColumnDef="valor_compra">
          <th class="p-2 text-center" mat-header-cell *matHeaderCellDef>
            {{ formatarParaReal(somaCategoria(codigo_categoria_compra())) }}
          </th>
          <td class="p-2 text-center" mat-cell *matCellDef="let element">
            {{ formatarStringParaReal(element.valor_compra) }}
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          (click)="detalhar(element)"
          *matRowDef="let element; columns: displayedColumns"
        ></tr>
      </table>
    </mat-card-content>
  </mat-card>
</div>
